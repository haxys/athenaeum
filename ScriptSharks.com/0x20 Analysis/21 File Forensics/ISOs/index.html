
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of documentation by Haxys Labs.">
      
      
        <meta name="author" content="Haxys Labs">
      
      
        <link rel="canonical" href="https://haxys.net/athenaeum/ScriptSharks.com/0x20%20Analysis/21%20File%20Forensics/ISOs/">
      
      
        <link rel="prev" href="../Emails/">
      
      
        <link rel="next" href="../../22%20Language%20Tricks/HTML%20and%20JS/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>ISO Files - Haxys Labs | Athenaeum</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dynamic-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Haxys Labs | Athenaeum" class="md-header__button md-logo" aria-label="Haxys Labs | Athenaeum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Haxys Labs | Athenaeum
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ISO Files
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/haxys/athenaeum/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Haxys Labs | Athenaeum" class="md-nav__button md-logo" aria-label="Haxys Labs | Athenaeum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Haxys Labs | Athenaeum
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/haxys/athenaeum/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ScriptSharks.com
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ScriptSharks.com
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0x00 History
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            0x00 History
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x00%20History/00%20Sipping%20from%20the%20Fire%20Hose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x00%20History/01%20In%20the%20Beginning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 In the Beginning...
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x00%20History/02%20Malware%20Explosion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 Malware Explosion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x00%20History/03%20The%2090s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03 Polymorphs, Macros and RATs! (Oh My!)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x00%20History/04%20Millenial%20Malware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 Millenial Malware
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x00%20History/05%20Ransomware%20Rising/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 Ransomware Rising
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0x10 Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            0x10 Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/10%20Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10 Let's Write Some Malware!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/11%20Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11 Malware Design Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    12 Droppers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            12 Droppers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/12%20Droppers/00%20Intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dropper Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/12%20Droppers/10%20Design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 0: Designing a Dropper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/12%20Droppers/20%20LNK/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 1: Stager and LNK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/12%20Droppers/30%20ISO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 2: Build the ISO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x10%20Design/12%20Droppers/40%20HTML/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 3: Assemble the HTML
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0x20 Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            0x20 Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../20%20Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20 Know the Enemy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    21 File Forensics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            21 File Forensics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Emails/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Emails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ISO Files
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ISO Files
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Static Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#via-pycdlib" class="md-nav__link">
    <span class="md-ellipsis">
      Via PyCDLib
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-fsarchive" class="md-nav__link">
    <span class="md-ellipsis">
      Via FS.Archive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#an-important-note" class="md-nav__link">
    <span class="md-ellipsis">
      An Important Note
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    22 Language Tricks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            22 Language Tricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../22%20Language%20Tricks/HTML%20and%20JS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTML and JavaScript
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0x30 Tools of the Trade
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            0x30 Tools of the Trade
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_1" >
        
          
          <label class="md-nav__link" for="__nav_2_5_1" id="__nav_2_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    30 Virtual Machines
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_1">
            <span class="md-nav__icon md-icon"></span>
            30 Virtual Machines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x30%20Tools%20of%20the%20Trade/30%20Virtual%20Machines/00%20Background/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Little VM History
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x30%20Tools%20of%20the%20Trade/30%20Virtual%20Machines/01%20Hypervisors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hypervisors 101
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x30%20Tools%20of%20the%20Trade/30%20Virtual%20Machines/02%20Guest%20OSes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guest OSes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_2" >
        
          
          <label class="md-nav__link" for="__nav_2_5_2" id="__nav_2_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    31 File Manipulation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            31 File Manipulation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0x30%20Tools%20of%20the%20Trade/31%20File%20Manipulation/Metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parsing File Metadata
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0xF0 About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            0xF0 About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0xF0%20About/FC%20Old%20News/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Old News
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0xF0%20About/FD%20Origins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ScriptSharks Origins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0xF0%20About/FE%20Changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../0xF0%20About/FF%20License/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dynamic-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamic Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#static-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Static Analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#via-pycdlib" class="md-nav__link">
    <span class="md-ellipsis">
      Via PyCDLib
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-fsarchive" class="md-nav__link">
    <span class="md-ellipsis">
      Via FS.Archive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#an-important-note" class="md-nav__link">
    <span class="md-ellipsis">
      An Important Note
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1>ISO Files</h1>

<p>Files ending with <code>.iso</code> are uncompressed archives designed to represent physical, write-only storage media, such as CD-R and DVD-R discs. ISO files contain not only the full, uncompressed content of every file in the archive, but also the exact structure of the data and additional filesystem information. This enables the creation of "perfect" copies when burning the ISO to a physical disc. For more information, check out the <a href="https://docs.fileformat.com/compression/iso/">FileFormat documentation for the ISO filetype</a>.</p>
<h2 id="dynamic-analysis">Dynamic Analysis</h2>
<p>Most modern OSes (Linux, macOS, Windows) include bundled methods for accessing the contents of ISO files. In these OSes, double-clicking the file will mount it as a virtual disc drive, as if it were a physical disc. In addition, many archive management utilities (such as <a href="https://www.7-zip.org/download.html">7zip</a>) allow users to extract the contents of an ISO file in the same manner as other archive types, such as <code>.zip</code>.</p>
<p>While convenient, these methods come with risks. For example, if a Windows system is configured to automatically launch installers from CDs and DVDs, then mounting an ISO as a virtual drive could trigger the execution of malware.</p>
<p>Opening an ISO with 7zip and similar utilities is a little safer, as they simply extract the archived files, rather than treating them as a virtual drive. However, there may still be risks.</p>
<p>In either case, as with all malware, ISO files should be opened in a properly-isolated VM.</p>
<h2 id="static-analysis">Static Analysis</h2>
<h3 id="via-pycdlib">Via PyCDLib</h3>
<p>It is also possible to examine ISO files interactively, using Python (or your language of choice). To demonstrate, we'll start with the <code>pycdlib</code> <a href="https://github.com/clalancette/pycdlib">library</a>. As this is not part of the <a href="https://docs.python.org/3/library/">standard library</a>, you'll need to install it before it can be used:</p>
<pre><code class="language-sh">(iso.venv) analyst@lab_vm iso.venv % pip install pycdlib
Collecting pycdlib
[...]
Successfully installed pycdlib-1.13.0
</code></pre>
<p>With <code>pycdlib</code> installed, we can now explore a malware ISO file. First, we'll need to mount the ISO:</p>
<pre><code class="language-python">&gt;&gt;&gt; import pycdlib
&gt;&gt;&gt; iso = pycdlib.PyCdlib()
&gt;&gt;&gt; iso.open(&quot;documents.iso&quot;)
</code></pre>
<p>With the ISO open, we can list the contents of the root directory:</p>
<pre><code class="language-python">&gt;&gt;&gt; for child in iso.list_children(iso_path=&quot;/&quot;):
...     print(child.file_identifier())
... 
b'.'
b'..'
b'DOCS'
b'STATEM~1.LNK;1'
</code></pre>
<p>We can also list contents of subdirectories in the same manner:</p>
<pre><code class="language-python">&gt;&gt;&gt; for child in iso.list_children(iso_path=&quot;/DOCS/&quot;):
...     print(child.file_identifier())
... 
b'.'
b'..'
b'INSTALL.PS1;1'
b'STATEM~1.DOC;1'
</code></pre>
<p>From our exploration, we can see the following directory structure:</p>
<ul>
<li><code>/</code><ul>
<li><code>/STATEM~1.LNK</code></li>
<li><code>/DOCS</code><ul>
<li><code>/DOCS/INSTALL.PS1</code></li>
<li><code>/DOCS/STATEM~1.DOC</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>We can also obtain a directory structure via the <code>iso.walk</code> method:</p>
<pre><code class="language-python">&gt;&gt;&gt; for dname, dlist, flist in iso.walk(iso_path=&quot;/&quot;):
...     print(f&quot;{dname}: {dlist} {flist}&quot;)
... 
/: ['DOCS'] ['STATEM~1.LNK;1']
/DOCS: [] ['STATEM~1.DOC;1', 'INSTALL.PS1;1']
</code></pre>
<p>We can gather information about specific files by their ISO path:</p>
<pre><code class="language-python">&gt;&gt;&gt; record = iso.get_record(iso_path=&quot;/DOCS/INSTALL.PS1;1&quot;)
&gt;&gt;&gt; record.is_file()
True
&gt;&gt;&gt; record.is_dir()
False
&gt;&gt;&gt; record.get_data_length()
12836
</code></pre>
<p>When done working with the ISO, be sure to close it:</p>
<pre><code class="language-python">&gt;&gt;&gt; iso.close()
</code></pre>
<h3 id="via-fsarchive">Via FS.Archive</h3>
<p>We can also use the <code>fs.archive</code> <a href="https://github.com/althonos/fs.archive">library</a>, another non-standard Python extension, which wraps around <code>pycdlib</code> to provide a simpler interface. To start, we'll need to install the package:</p>
<pre><code class="language-sh">(iso.venv) analyst@lab_vm iso.venv % pip install fs.archive
Collecting fs.archive
[...]
Successfully installed appdirs-1.4.4 fs-2.4.16 fs.archive-0.7.3
</code></pre>
<p>With the utility installed, we can open the ISO:</p>
<pre><code class="language-python">&gt;&gt;&gt; from fs import open_fs
&gt;&gt;&gt; from fs.archive import open_archive
&gt;&gt;&gt; root = open_fs(&quot;./&quot;) # Path where the ISO is stored.
&gt;&gt;&gt; archive = open_archive(root, &quot;documents.iso&quot;)
&gt;&gt;&gt; archive.isempty(path=&quot;/&quot;)
False
</code></pre>
<p>We can now explore the contents of the ISO:</p>
<pre><code class="language-python">&gt;&gt;&gt; for path, dirs, files in archive.walk():
...     print(f&quot;{path}:\n\tDirs: {dirs}\n\tFiles: {files}&quot;)
... 
/:
        Dirs: [&lt;dir 'docs'&gt;]
        Files: [&lt;file 'statem~1.lnk'&gt;]
/docs:
        Dirs: []
        Files: [&lt;file 'install.ps'&gt;, &lt;file 'statem~1.doc'&gt;]
</code></pre>
<p>We can now extract the contained files:</p>
<pre><code class="language-python">&gt;&gt;&gt; def save(path):
...     fname = path.split(&quot;/&quot;)[-1]
...     f = archive.open(path=path)
...     contents = f.buffer.readall()
...     with open(fname, 'wb') as outfile:
...         outfile.write(contents)
...     f.close()
... 
&gt;&gt;&gt; for path in [
...     &quot;/statem~1.lnk&quot;,
...     &quot;/docs/install.ps&quot;,
...     &quot;/docs/statem~1.doc&quot;
... ]:
...     save(path)
</code></pre>
<p>After executing this code, we should have three new files in our working directory:</p>
<pre><code class="language-sh">(iso.venv) analyst@lab_vm iso.venv % ls -l
total 11656
drwxr-xr-x  8 analyst  staff      256 Dec 19 15:28 .
drwxr-xr-x@ 5 analyst  staff      160 Dec 19 15:28 ..
-rw-r--r--@ 1 analyst  staff  1245184 Dec 19 13:40 documents.iso
-rw-r--r--  1 analyst  staff    12836 Dec 19 15:25 install.ps
-rw-r--r--@ 1 analyst  staff  1992525 Dec 13 16:01 statement.htm
-rw-r--r--  1 analyst  staff     5467 Dec 19 15:25 statem~1.doc
-rw-r--r--  1 analyst  staff     2357 Dec 19 15:25 statem~1.lnk
-rw-r--r--  1 analyst  staff  2698674 Dec 13 15:45 suspicious.eml
</code></pre>
<p>The files are cleanly extracted, ready for further analysis!</p>
<h3 id="an-important-note">An Important Note</h3>
<p>The demonstrated methods do not preserve the files' original names. This is, in part, due to the way filenames are saved in ISO files and parsed by the referenced Python libraries. This does not directly represent what is observed when the ISO is opened on a host, but this could be seen as a benefit; malware distributed by ISO often employs tricks that are path-dependent, such as the LNK file in the sample, which calls the PS1 file by name. If the name is changed (such as <code>statement.doc.lnk</code> being compressed to <code>statem~1.lnk</code>), this can break the malware's functionality.</p>
<p>To preserve filenames, you may want to use the dynamic methods, such as mounting the image, or extracting it with 7zip.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2024 Haxys Labs &colon;&colon; This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>