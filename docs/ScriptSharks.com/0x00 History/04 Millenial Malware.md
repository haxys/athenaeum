---
title: "04 Millenial Malware"
---

> "I think everybody's got a malicious side." ~[Jonathan Rhys Meyers](https://www.imdb.com/name/nm0001667/)

# ILU <3

On May 5th, 2000, overflowing with love (but too late for Valentine's Day), 24-year-old Onel de Guzman shared his "Love Letter" worm ([ILOVEYOU](https://en.wikipedia.org/wiki/ILOVEYOU)) with the world, infecting over 10 million systems. The worm spread by email, containing a malicious `.vbs` attachment which trashes the user's drives before forwarding itself to all the people in their address book. Considering data loss and the cost of remediation, the worm caused an estimated US$15-24 billion in damages.

For some reason, the world wasn't thrilled with Onel's exhuberant expression of adoration. Still, he never served time; the Philippines had no laws against writing malware at the time, so all charges were dropped. (They passed laws after-the-fact, but couldn't charge him for crimes committed prior.)

Onel set the bar high, but malware authors love a challenge.

# Tennis Star Goes Viral

At the peak of her sports career, tennis star [Anna Kournikova](https://en.wikipedia.org/wiki/Anna_Kournikova) achieved super-stardom. Mixed drinks and poker hands were named after her. She had a licensed PlayStation game, released in Japan and Europe. She was so famous that between 2001 and 2003, her name was among the top most-searched terms on Google.

Looking to cash in on that fame, 20-year-old Jan de Wit released the [Vbs.OnTheFly](https://en.wikipedia.org/wiki/Anna_Kournikova_(computer_virus)) wormâ€”known more widely as the "Anna Kournikova virus"â€”in February of 2001. Like the ILOVEYOU worm, the virus used a `.vbs` email attachmentâ€”masquerading as a risque photo of the namesake tennis starâ€”to infect the system. Like its predecessor, the worm would send itself to everyone in the user's Outlook address book. Unlike its predecessor, the worm did not cause any damage to systems it infected.

The worm infected millions of systems and caused problems in email servers worldwide. But here's the kicker... de Wit didn't hand-craft OnTheFly. He used a simple online VBS Worm Generator tool, originally created by an Argentinian hacker called [K]Alamar. He created the worm to see whether security had improved in the year following the ILOVEYOU worm. (Clearly it hadn't.) He attributed the worm's success to the world's unhealthy obsession with Kournikova.

Jan served 150 hours of community service.

# Worms of Mass Destruction

2001 saw a flood of additional worms:

* Magistr, a sophisticated email worm targeting people in the legal profession.
* [Sadmind](https://en.wikipedia.org/wiki/Sadmind_worm), which spread by exploiting Sun Solaris and Microsoft IIS.
* [Sircam](https://en.wikipedia.org/wiki/Sircam), which spread through Microsoft systems via email and unprotected network shares.
* [Code Red](https://en.wikipedia.org/wiki/Code_Red_(computer_worm)), which spread via Microsoft IIS exploits.
* [Code Red II](https://en.wikipedia.org/wiki/Code_Red_II), because everybody loves a good sequel.
* [Nimda](https://en.wikipedia.org/wiki/Nimda), which spread not only via Windows exploits, but via existing Code Red II and Sadmind infections.
* [Klez](https://en.wikipedia.org/wiki/Klez), which exploited Microsoft Internet Explorer, Outlook, and Outlook Express.

2002 had a nice change of pace, starting with the [Simile virus](https://en.wikipedia.org/wiki/Simile_(computer_virus)), written in Assembly by "Mental Driller." The virus would lay dormant, activate on a semi-random date, show a "Free Palestine" message, then _completely rebuild itself_, shuffling around its code prior to infecting random files on the system. This resulted in a constantly-changing viral fingerprint, which made the malware remarkably resilient and difficult to detect.

Following Simile, 2002 brought [Beast](https://en.wikipedia.org/wiki/Beast_(trojan_horse)) (yet another RAT), then skipped right back to worms with [Mylife](https://en.wikipedia.org/wiki/Mylife_(computer_worm)), which spread via... can you guess? That's right! A `.vbs` email attachment that forwards itself to everyone in the user's Outlook address book.

Nobody said malware authors had to be original.

# Worms Without Borders

In 2003, aside from a couple RATs, it was worms all the way down:

* [SQL Slammer](https://en.wikipedia.org/wiki/SQL_Slammer), spreading via Microsoft SQL Server.
* [Blaster](https://en.wikipedia.org/wiki/Blaster_(computer_worm)), exploiting Windows system services.
* [Welchia](https://en.wikipedia.org/wiki/Welchia), which attempts to remove Blaster and patch Windows. ([Sounds familiar...](./01 In the Beginning.md#creeper-and-reaper))
* [Sobig](https://en.wikipedia.org/wiki/Sobig), which spread across Windows systems via email and network shares.
* [Swen](https://en.wikipedia.org/wiki/Swen_(computer_worm)), daring to think different. (This one is written in C++!)
* [Sober](https://en.wikipedia.org/wiki/Sober_worm), yet another `.vbs` worm.
* [Agobot](https://en.wikipedia.org/wiki/Agobot), which exploited Windows vulnerabilities.
* [Bolgimo](https://en.wikipedia.org/wiki/Bolgimo), which exploited Windows vulnerabilities.

2004 continued the trend:

* [Bagle](https://en.wikipedia.org/wiki/Bagle_(computer_worm)), [MyDoom](https://en.wikipedia.org/wiki/MyDoom), [Netsky](https://en.wikipedia.org/wiki/Netsky_(computer_worm)), and [Witty](https://en.wikipedia.org/wiki/Witty_worm) all followed closely in their predecessors' footsteps.
* [Sasser](https://en.wikipedia.org/wiki/Sasser_worm) exploited Windows LSASS (but removed MyDoom and Bagle).
* [Caribe](https://en.wikipedia.org/wiki/Caribe_(computer_worm)) broke from the pack, becoming the first worm to infect mobile phones, spreading via Bluetooth.
* [Santy](https://en.wikipedia.org/wiki/Santy) became the first-known "webworm," exploiting online forums running [phpBB](https://www.phpbb.com/). It used Google to find new targets, and infected around 40,000 sites before Google filtered the malicious search query.

The worms did not stop. Legends say they're still spreading to this very day... (Like RATs, I'll only cover notable worms from here on.)

# Corporate Rootkits? In _My_ Home PC?

It's more likely than you'd think! While the swarm of worms continued in 2005, [Sony BMG](https://en.wikipedia.org/wiki/Sony_BMG) (a now-defunct music-and-entertainment venture) stole the headlines when researchers discovered [two subversive rootkits designed to impede digital piracy](https://en.wikipedia.org/wiki/Sony_BMG_copy_protection_rootkit_scandal). The rootkits hid from the system, preventing users from copying CDs, and "phoning home" to report on users' activity. They violated copyrights, installed without user consent, and created vulnerabilities which were exploited by unrelated malware.

To quell the public outrage, Sony BMG released an uninstaller for one of the rootkitsâ€”though the uninstaller failed to uninstall the rootkit, and actually introduced _more malware and vulnerabilities_ onto affected systems.

Hoping to smooth things over, Sony BMG paid out a few settlements, recalled 10% of the infected CDs, and pinky-promised they'd never do it again.

# How the Mighty Have Fallen

In February of 2006, Mac OS X fansâ€”who, like their Linux counterparts, had long boasted immunity to malwareâ€”were dismayed by the news of a trojan (known as `OSX/Leap-A` or `OSX/Oompa-A`) designed to infect Mac systems. Fortunately, the trojan didn't pose much threat, so theyâ€”like their Linux counterpartsâ€”continued to boast immunity, despite evidence to the contrary.

Following on its heels, the [Stardust Macro Virus](https://www.informationweek.com/it-life/first-openoffice-macro-virus-appears) (a.k.a. "Starbucks") was the first macro virus for StarOffice and OpenOffice. Proponents of these office suites oft claimed that they were more secure than Microsoft Office, as they didn't employ Microsoft's VBS macro language. The Stardust virus shattered their dreams, proving that nothing is sacred, and no one is safe. ([OpenOffice](https://www.openoffice.org/) and [LibreOffice](https://www.libreoffice.org/) are still excellent alternatives for those looking to kick their Microsoft habit.)

# From Olympus With Love

In 2007, the [Zeus](https://en.wikipedia.org/wiki/Zeus_(malware)) banking trojan was unleashed on Windows systems. The malware stole banking information via keystroke logging, and spread to about 3.6 million systems in the U.S. alone. When the malware ring was busted, over 100 people were charged with conspiracy to commit bank fraud and launder money, having stolen approximately US$70 million.

The original author was never caught, and is believed to have retired in 2010.

# Infect Your Treasured Memories Today

In 2008, the [Mocmex](https://en.wikipedia.org/wiki/Mocmex) trojan spread via digital photo frames, infecting computers to which the frames were attached. The malware employed complex anti-detection mechanisms and disabled system protections, all so it could steal passwords for online game accounts.

Industry experts called it the "nuclear bomb of malware," proving once again that industry experts have a flair for the dramatic.

# Malware for Everyone!

2008 also saw the [Bohmini.A RAT](https://en.wikipedia.org/wiki/Bohmini.A), which exploited Adobe Flashâ€”a notoriously-insecure software that [just refused to die](https://www.infoworld.com/article/2610420/adobe-flash--insecure--outdated--and-here-to-stay.html) until [Adobe finally killed it in 2021](https://www.adobe.com/products/flashplayer/end-of-life.html).

In July, the [Koobface](https://en.wikipedia.org/wiki/Koobface) worm spread across users of Facebook and Myspace, as well as other social networks, infecting Windows, Mac OS X and Linux indiscriminately. Much to the chagrin of its designers, Koobface's notoriety was soon overshadowed by that of [Conficker](https://en.wikipedia.org/wiki/Conficker), a worm that infected up to 15 million systems, including numerous government, military, police and hospital networks. Four of Conficker's creators were arrested, but only one served time, spending four years in prison.

# Tracking Trends

Malware, as with everything, is subject to trends. For each new strain that breaks the mold, a dozen copy-cats will spring up in its wake. Malware authors are pragmatic. "If it ain't broke, don't fix it." An entire decade of email worms propagated via `.vbs` email attachments, preying on gullible users. Microsoft failed to prevent these attacks, so they just kept coming. There may have been a few creative malware authors out there, but the vast majority just copied each other's work, making only minor tweaks to existing code.

The same is true today. The "malware du jour" may have shifted from RATs to worms to ransomware, but everyone's still playing "follow the leader," parroting popular paradigms in malware design. Every time a new 0-day drops, malware authors race to exploit it for as long as possible, while software developers struggle to patch their software. Once the bug is patched, malware authors bide their time awaiting the next big 0-day, when they can do it all again. In fact, so many attackers employ similar tactics that in 2013, MITRE created the [ATT&CK](https://attack.mitre.org/) framework to document them all.

Naturally, the ATT&CK framework is an excellent resource for aspiring pentesters and malware authors/analysts, providing excellent documentation of common Tactics, Techniques and Procedures (TTPs). If you haven't yet, you should check it out. It's not as deep a rabbit-hole as [TVTropes](https://tvtropes.org/), the "all-devouring pop-culture wiki," but you could still get lost for hours, exploring all the data on MITRE's site.

(No, I'm not sponsored by MITRE. Though I wouldn't turn down their money... ðŸ‘€)